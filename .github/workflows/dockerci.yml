name: docker compose CI
on: 
  push:
    branches:
      - main
      - dev
  pull_request:
    branches:
      - main
      - dev
jobs:
  docker-compose-build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: docker compose build --no-cache
      - run: docker compose up -d
      - name: wait for services to be up
        uses: ifaxity/wait-on-action
        with:
          resource: http://localhost:8500
          timeout: 3000
      - run: docker exec vue-cli npm --prefix /usr/src/app/app run test
